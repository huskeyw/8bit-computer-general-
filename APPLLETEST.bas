10 REM overly complex program to test which apple you have
20 REM http://www.1000bit.it/support/manuali/apple/technotes/misc/tn.misc.07.html
20 LET D=0:LET H$ = "": LET C$= "I DONT KNOW WHAT YOU HAVE":HOME
30 DIM A$(6):REM SET MEMORY LOCATIONS
40 A$(1)="FBB3":A$(2)="FB1E":A$(3)="FBC0":A$(4)="FBDD":A$(5)="FBBE":A$(6)="FBBF"
50 PRINT "Testing Memory location $FBB3":FOR XX = 1 TO 100
60 H$=A$(1): GOSUB 1000
70 AN = PEEK(D)
80 GOSUB 3000
85 PRINT: PRINT
90 PRINT "THANK YOU FOR ANY FEEDBACK":PRINT "CONTACT WILLIAM.HUSKEY@GMAIL.COM":PRINT "    -- END OF LINE --"
100 END

1000 REM HEX TO DEC 
1010 REM needs all 4 digits.. so $60 should be $0060
1020 REM SET A MASK TO H$ IF IT IS SMALLER THAN 4 DIGITS

1030 D=0:IF LEN(H$) = 1 THEN H$="000"+H$
1040 D=0:IF LEN(H$) = 2 THEN H$="00"+H$
1050 D=0:IF LEN(H$) = 3 THEN H$="0"+H$

1060 FOR I=0 TO 3
1070 N=ASC(MID$(H$,I+1,1))-48
1080 IF N<10 THEN D=D+N*(16^(3-I))
1090 IF N>16 THEN D=D+(N-7)*(16^(3-I))
1100 NEXT I
1110 RETURN : REM returns D

2000 REM  DEC TO HEX will return H$
2010 H$ = ""
2020 A = D - INT (D / 16) * 16 
2030 D = INT (D / 16)
2040 B = A + ASC ("0")
2050 IF A < 10 GOTO 2070
2060 B = A - 10 + ASC ("A")
2070 H$ = CHR$ (B) + H$ 
2080 IF D > 0 GOTO 2020
2090 RETURN : REM returns H$

3000 REM test for COMPUTER type
3010 IF AN = 56 GOTO 3100 : REM CHECKING FOR HEX $38
3020 IF AN = 234 GOTO 3200 : REM CHECK FOR HEX $EA
3030 IF AN = 6 GOTO 3300: REM CEHCK FOR HEX $06
3040 IF AN = 201 GOTO 3600: REM CHECK FOR HEX $C9
3050 GOTO 4000

3100 REM APPL ][ 
3110 C$ = "YOU HAVE AN APPLE ]["
3120 GOTO 4000

3200 REM test ][+ OR /// IN EMULATION
3210 H$ = A$(2): GOSUB 1000
3220 D = PEEK(D): GOSUB 2000
3230 IF H$ = "AD" THEN C$ = "YOU HAVE AN APPLE ][+" : GOTO 4000
3240 IF H$ = "8A" THEN C$ = "YOU HAVE AN APPLE /// WITH ][+ EMULATOR" 
3250 GOTO 4000

3300 REM test IIE OR IIC
3310 H$ = A$(3):GOSUB 1000
3320 D=PEEK(D):GOSUB 2000
3330 IF H$ = "EA" THEN PRINT: PRINT "YOU HAVE AN APPLE IIE " : GOTO 4000
3340 IF H$ = "E0" THEN GOTO 3400
3350 IF H$= "0" THN GOTO 3500
3360 GOTO 4000

3400 REM TEST IIE ENCHANGED OR IIE WITH OPTION CARD
3410 H$ = A$(4):GOSUB 1000
3420 D = PEEK(D): GOSUB 2000
3430 IF H$ = "2" THEN C$ = "YOU HAVE AN MACINTOSH WITH IIE CARD": GOTO 4000
3440 H$ = A$(2):GOSUB 1000 : REM CHECK FOR POSSIABLE GS
3450 D = PEEK(D):GOSUB 2000
3460 IF H$ = "4C" THEN C$ = "YOU MAY HAVE A GS --LET ME KNOW" : GOTO 4000
3470 C$ = "YOU HAVE AN APPLE IIE ENHANCED 65C02"
3480 GOTO 4000 

3500 REM TEST IIC AND LATER
3510 H$ = A$(6):GOSUB 1000
3520 D = PEEK(D): GOSUB 2000
3530 IF H$ = "FF" THEN C$ = "YOU HAVE AN APPLE IIC": GOTO 4000
3540 IF H$ = "0" THEN C$ = "YOU HAVE AN APPLE IIC 3.5 ROM": GOTO 4000
3550 IF H$ = "3" THEN C$ = "YOU HAVE AN APPLE IIC ORIG": GOTO 4000
3560 IF H$ = "4" THEN C$ = "YOU HAVE AN APPLE IIC REV": GOTO 4000
3570 IF H$ = "5" THEN C$ = "YOU HAVE AN APPLE IIC+": GOTO 4000
3590 GOTO 4000

3600 REM ][ j+
3610 C$ = "THIS IS A VERY RARE!!!":PRINT"APPLE ii JAPAN MODEL"
3620 GOTO 4000


4000 REM PRINT MEMORY LOCATIONS
4010 PRINT:PRINT C$:PRINT 
4020 FOR XX = 1 TO 40 : PRINT "*";: NEXT XX
4030 FOR X = 1 TO 6
4040 H$ = A$(X): GOSUB 1000
4050 D = PEEK(D) : GOSUB 2000
4060 PRINT "MEMORY LOCATION:";:PRINT A$(X);: PRINT " = ";: PRINT H$
4070 NEXT X
4080 FOR XX = 1 TO 40 : PRINT "*";: NEXT XX
4090 RETURN


